# Project Title
Related to thesis

`An Innovative Application of Blockchain Technology in IoT Device Management: 
Authentication, Authorization, and Enhanced Secure with NFT Smart Contracts And Dapp`

This project is a concrete software implementation of my thesis

This project is based on the Example project MetaMask/test-dapp [here](https://github.com/MetaMask/test-dapp)

## Prerequisites

- nvm (Node Version Manager)
- Node.js
- yarn package manager
- Python 3
- ecdsa Python library
- web3 Python library
- paho-mqtt Python library
- Ganache (local blockchain for testing purposes)
- Metamask (browser extension wallet for Ethereum)
- eth-sig-util(JavaScript library for ethereum (DApp) development)
- ethereumjs-util(JavaScript library for ethereum (DApp) development)
- webpack(Static Module Packaging Tool)
- ethers.ts(TypeScript library for ethereum (DApp) development)
## Installation

1. Install nvm using the instructions found [here](https://github.com/nvm-sh/nvm#installing-and-updating).
2. Install Node.js using nvm:

```bash
nvm install 14.21.3
nvm use 14.21.3
```

3. Install yarn using npm:

```bash
npm install --global yarn
```

4. Install  the required Python libraries:

```bash
pip install ecdsa==0.18.0
pip install web3==5.22.0
web3 paho-mqtt==1.6.1
```

5. Install Ganache by downloading it from the official website [here](https://www.trufflesuite.com/ganache).
6. Install Metamask by adding the extension to your Chrome browser [here](https://metamask.io/).

## Deployment

1. Clone this repository.
2. Open Ganache and create a new workspace.
3. Connect MetaMask to Ganache, open MetaMask and click Add Network, `Add Network Manually`, then enter `Ganache` in the network name, `HTTP://127.0.0.1:7545` in the new PRC URL, and `1337` in the chain ID, as the RPC endpoint uses a different chain so here Enter 1337 instead of 5777, enter `ETH` for the currency symbol, and click Save
4. Add blockchain accounts and import the Ganache-generated private keys of any of the 10 accounts with 100 ETH into MetaMask
5. To deploy smart contracts, use Remix [here](https://remix.ethereum.org), create a new workspace, select an empty Template, then upload all the smart contracts in the Contracts directory, compile the `DeviceOwnership.sol` contract, select `Injected Provider - MetaMask` in the environment of the deployment interface to connect to The Ganache test network that MetaMask is currently connected to, then click `Deploy` to complete the deployment
6. Copy the address of the deployed contract from Remix's Deployed Contracts to /iot-simulator/smart_contract.py and modify contract = w3.eth.contract(address='`replace with the address you deployed`', abi=abi)
7. Copy the deployed contract address from the Deployed Contracts in Remix and change const contractAddress = '`replace with the address you deployed`' in /src/assets/js/index.js.
8. As an optional step, copy the `ABI` binaries generated by the Remix compilation to replace the contents of /src/iotcontract.json and /iot-simulator/abi.json. If you have not modified the smart contract code, you do not need to perform this step
9. Go to the iot-simulator folder and run the IOT simulator
```bash
python main.py
```
10. In the root directory of the project, run `yarn` to install the required dependencies.
11. Use the command to run Dapp at http://localhost:9011/
```bash
yarn start
```

## Usage

Using the Dapp front-end you can now perform actions to try to register by copying a device address from the IOT simulator using `REGISTER NEW DEVICE `,for the IOT simulator in should connect to the ethereum blockchain and be able to interact with the deployed smart contract. Immediately after registration you should see that the IOT simulator has read your details from the blockchain and you can now test the rest of the functionality

## License

This project inherits the MIT license adopted by MetaMask/test-dapp for licensing. See the LICENSE document for details.